<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JPG → PNG Converter — Bright Yellow & Blue</title>
  <style>
    :root{
      --brand-yellow:#ffdd00;
      --brand-blue:#0066cc;
      --bg:#fffef8;
      --card:#ffffff;
      --muted:#556;
      --shadow: 0 8px 30px rgba(2,6,23,0.07);
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#ffffff);color:#0b1220;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
    .app{width:100%;max-width:980px;background:var(--card);border-radius:12px;box-shadow:var(--shadow);overflow:hidden}
    header{display:flex;align-items:center;gap:12px;padding:16px 20px;border-bottom:4px solid var(--brand-yellow)}
    .mark{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--brand-yellow),var(--brand-blue));display:flex;align-items:center;justify-content:center;font-weight:700;color:#003}
    h1{font-size:18px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .content{display:grid;grid-template-columns:1fr 380px;gap:18px;padding:20px}
    @media(max-width:900px){.content{grid-template-columns:1fr;}}

    .left{padding:16px}
    .drop{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;padding:26px;border-radius:10px;border:2px dashed rgba(0,102,204,0.08);background:linear-gradient(180deg,rgba(255,221,0,0.02),transparent)}
    .drop input{display:none}
    .hint{font-size:14px;color:var(--muted)}
    .controls{margin-top:12px;display:flex;flex-direction:column;gap:12px}
    .row{display:flex;gap:10px;align-items:center}
    input[type="text"], input[type="number"], select{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);font-size:14px}
    button{background:var(--brand-blue);color:white;padding:10px 14px;border-radius:10px;border:0;font-weight:600;cursor:pointer}
    button.secondary{background:transparent;color:var(--brand-blue);border:1px solid rgba(0,102,204,0.12)}

    .right{padding:16px;border-left:1px solid rgba(0,0,0,0.03)}
    .preview{display:flex;flex-direction:column;gap:10px;align-items:center}
    .canvas-wrap{width:100%;max-width:360px;border-radius:10px;background:#f7faff;border:1px solid rgba(0,102,204,0.06);padding:10px;display:flex;align-items:center;justify-content:center;min-height:220px}
    .canvas-wrap img{max-width:100%;max-height:480px;border-radius:8px}
    .meta{font-size:13px;color:var(--muted)}

    .foot{padding:12px 20px;border-top:1px solid rgba(0,0,0,0.03);display:flex;justify-content:space-between;align-items:center}
    .small{font-size:13px;color:var(--muted)}

    @media(max-width:480px){
      .mark{width:42px;height:42px}
      header{padding:12px}
      .content{padding:12px}
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="mark">J→P</div>
      <div>
        <h1>JPG → PNG Converter</h1>
        <p class="lead">Convert JPG images to PNG. Bright yellow & blue theme — mobile-responsive.</p>
      </div>
    </header>

    <div class="content">
      <section class="left">
        <div class="drop" id="dropzone">
          <input id="fileInput" type="file" accept="image/jpeg,image/jpg">
          <div style="text-align:center">
            <strong style="color:var(--brand-blue)">Upload or drop a JPG image</strong>
            <div class="hint">JPG/JPEG — up to 25MB</div>
          </div>
          <div style="display:flex;gap:8px;margin-top:12px">
            <button id="pickBtn" class="secondary">Choose File</button>
            <button id="clearBtn" class="secondary">Clear</button>
          </div>
        </div>

        <div class="controls">
          <div>
            <label style="font-size:13px;color:#123;display:block;margin-bottom:6px">Output Options</label>
            <div class="row">
              <label style="display:flex;gap:8px;align-items:center"><input id="keepName" type="checkbox" checked> Keep original name</label>
            </div>
            <div style="margin-top:8px;font-size:13px;color:var(--muted)">PNG output is lossless. File size may be larger than JPG.</div>
          </div>

          <div class="row">
            <button id="previewBtn">Preview PNG</button>
            <button id="downloadBtn">Convert & Download PNG</button>
          </div>
        </div>
      </section>

      <aside class="right">
        <div class="preview">
          <div class="canvas-wrap" id="previewWrap">
            <div style="text-align:center;color:var(--muted)">No image loaded</div>
          </div>
          <div class="meta" id="meta">Nothing to show</div>
        </div>
      </aside>
    </div>

    <div class="foot">
      <div class="small">Designed for multi-tool sites • Theme: Yellow & Blue</div>
      <div style="font-size:13px;color:var(--muted)">Supports modern browsers (Chrome/Edge/Firefox/Safari)</div>
    </div>
  </div>

<script>
(() => {
  const fileInput = document.getElementById('fileInput');
  const pickBtn = document.getElementById('pickBtn');
  const clearBtn = document.getElementById('clearBtn');
  const dropzone = document.getElementById('dropzone');
  const previewWrap = document.getElementById('previewWrap');
  const meta = document.getElementById('meta');
  const previewBtn = document.getElementById('previewBtn');
  const downloadBtn = document.getElementById('downloadBtn');
  const keepName = document.getElementById('keepName');

  let currentFile = null;
  let currentBitmap = null;
  let naturalW = 0, naturalH = 0;

  function reset(){
    previewWrap.innerHTML = '<div style="text-align:center;color:var(--muted)">No image loaded</div>';
    meta.textContent = 'Nothing to show';
    currentFile = null; currentBitmap = null; naturalW = 0; naturalH = 0;
    fileInput.value = '';
  }

  function showMeta(){
    if(!currentFile) return;
    meta.textContent = `${currentFile.name} — ${naturalW}×${naturalH}px — ${(currentFile.size/1024/1024).toFixed(2)}MB`;
  }

  function showPreview(src){
    previewWrap.innerHTML = '';
    const img = document.createElement('img');
    img.src = src;
    img.alt = 'Preview';
    previewWrap.appendChild(img);
  }

  pickBtn.addEventListener('click', ()=>fileInput.click());
  clearBtn.addEventListener('click', ()=>reset());

  fileInput.addEventListener('change', async (e)=>{
    const f = e.target.files && e.target.files[0];
    if(f) await loadFile(f);
  });

  ['dragenter','dragover'].forEach(ev=>{dropzone.addEventListener(ev,(e)=>{e.preventDefault();dropzone.style.boxShadow='inset 0 0 0 2px rgba(0,102,204,0.06)';});});
  ['dragleave','drop'].forEach(ev=>{dropzone.addEventListener(ev,(e)=>{e.preventDefault();dropzone.style.boxShadow='none';});});
  dropzone.addEventListener('drop', async (e)=>{
    const f = e.dataTransfer.files && e.dataTransfer.files[0];
    if(f) await loadFile(f);
  });

  async function loadFile(file){
    if(!file.type.startsWith('image/')){alert('Please upload a JPG/JPEG image.');return}
    // accept only jpg/jpeg
    if(!(file.type === 'image/jpeg' || file.type === 'image/jpg')){
      if(!confirm('Selected file is not JPEG. Continue anyway?')) return;
    }
    currentFile = file;
    const url = URL.createObjectURL(file);
    showPreview(url);

    const img = new Image();
    img.src = url;
    await img.decode().catch(()=>{});
    naturalW = img.naturalWidth || img.width;
    naturalH = img.naturalHeight || img.height;
    showMeta();

    try{
      if('createImageBitmap' in window){
        currentBitmap = await createImageBitmap(file);
      } else {
        currentBitmap = null;
      }
    }catch(err){
      currentBitmap = null;
    }
  }

  async function drawToCanvas(){
    if(!currentFile) throw new Error('No file loaded');
    const canvas = document.createElement('canvas');
    canvas.width = naturalW || 800;
    canvas.height = naturalH || 600;
    const ctx = canvas.getContext('2d');
    ctx.imageSmoothingEnabled = true;
    ctx.imageSmoothingQuality = 'high';

    if(currentBitmap){
      ctx.drawImage(currentBitmap,0,0,canvas.width,canvas.height);
    } else {
      const img = new Image();
      img.src = URL.createObjectURL(currentFile);
      await img.decode().catch(()=>{});
      ctx.drawImage(img,0,0,canvas.width,canvas.height);
    }
    return canvas;
  }

  previewBtn.addEventListener('click', async ()=>{
    try{
      if(!currentFile){alert('Load a JPG image first');return}
      previewWrap.innerHTML = '<div style="padding:18px;color:var(--muted)">Creating PNG preview…</div>';
      const canvas = await drawToCanvas();
      const dataUrl = canvas.toDataURL('image/png');
      showPreview(dataUrl);
      meta.textContent = `Preview PNG: ${canvas.width}×${canvas.height}px`;
    }catch(err){
      alert('Error creating preview: '+(err.message||err));
      console.error(err);
    }
  });

  downloadBtn.addEventListener('click', async ()=>{
    try{
      if(!currentFile){alert('Load a JPG image first');return}
      downloadBtn.disabled = true; downloadBtn.textContent = 'Converting...';
      const canvas = await drawToCanvas();
      canvas.toBlob((blob)=>{
        if(!blob){alert('Could not create PNG file'); downloadBtn.disabled=false; downloadBtn.textContent='Convert & Download PNG'; return}
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        const baseName = keepName.checked ? currentFile.name.replace(/\.[^.]+$/, '') : 'image';
        link.download = `${baseName}.png`;
        document.body.appendChild(link);
        link.click();
        setTimeout(()=>{URL.revokeObjectURL(link.href); link.remove();},1500);
        downloadBtn.disabled=false; downloadBtn.textContent='Convert & Download PNG';
      }, 'image/png');
    }catch(err){
      alert('Error while converting: '+(err.message||err));
      console.error(err);
      downloadBtn.disabled=false; downloadBtn.textContent='Convert & Download PNG';
    }
  });

  // allow clicking preview to open image in new tab
  previewWrap.addEventListener('click',()=>{
    const img = previewWrap.querySelector('img');
    if(img) window.open(img.src,'_blank');
  });

})();
</script>
</body>
</html>
